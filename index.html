<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">

        <!-- Meta-information -->
        <title>A Cloud2Class Presentation : Practical Ansible</title>
        <meta name="description" content="Cloud2Class training material is brought to you by Bright Process Ltd">
        <meta name="author" content="Bright Process Ltd">

        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/beige.css" id="theme">
        <link rel="stylesheet" href="lib/css/zenburn.css">
        <link rel="stylesheet" href="css/cloud2class.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>
    <body>
        <div class="reveal">

            <!-- Any section element inside of this container is displayed as a slide -->
            <div class="slides">

                <!--Footer for all slides -->
                <div class='footer'>
                    content by <a href="https://cloud2class.com"><b>Cloud2Class</b></a>
                    &nbsp; -  &nbsp;workshop brought to you by <a href="http://www.equalexperts.com/"><b>Equal Experts</b></a>
                </div>
                <!-- Start of Content -->


                <!-- Frontpage: Practical Ansible -->
                <!-- Synopsis: Half day practical workshop -->
                <!-- Level: Beginner -->
                <section>
                    <h3>Welcome to</h3>
                    <h1 class="col_aid_five lighttext">Practical Ansible</h1>
                    <h3>A half day workshop</h3>
                    <h3>designed to get you up and running</h3>
                    <hr>
                    <img align=bottom valign=bottom style="padding: 5px; background: white;max-width: 40%; border-color: #0B486B;" src="images/sponsor-Equal-Experts.jpg">
                    <p/>
                </section>


                <!-- Module: Introduction -->
                <!-- Description: Introduction to the workshop -->
                <section>

                    <!-- Introduction: Splash page -->
                    <section>
                        <aside class="notes">
                            <br>Previous experience
                            <br>Configuration Management
                            <br>We will run through
                            <br> - Who we are
                            <br> - the structure of the workshop
                            <br> - what you should get out of the workshop
                        </aside>
                        <h2 class="col_aid_five lighttext">Introduction</h2>
                        <p>
                        <p><img style="max-height: 500px; border-color: #0B486B;" src="images/ansible-logo.png">
                    </section>
                </section>


                <!-- Topic Section: Who We are -->
                <!-- Description: Introducing the companies -->
                <section data-background="#A8DBA8">

                    <!-- Cloud2Class introduction -->
                    <section data-transition='fade'>
                        <h3 class="col_aid_four lighttext">Who We Are</h3>
                        <aside class="notes">
                            default
                        </aside>
                        <p>&nbsp;</p>

                            <p>The workshop is supplied and provisioned by...</p>
                            <ul>
                                <li><b>Equal Experts</b></li>
                            </ul>
                            <p>and content and delivery is provided by...</p>
                            <ul>
                                <li><b>Cloud2Class</b></li>
                            </ul>
                    </section>
                    <section data-transition='fade'>
                        <h3>Equal Experts</h3>
                        <a href="www.equalexperts.com">www.equalexperts.com</a>
                        <hr>
                        <p>Making Software. Better.</p>
                        <p>Simple solutions to big business problems.</p>
                        <img align=bottom valign=bottom style="padding: 5px; background: white;max-width: 40%; border-color: #0B486B;" src="images/sponsor-Equal-Experts.jpg">
                    </section>
                    <section data-transition='fade'>
                        <h3>Cloud2Class</h3>
                        <a href="www.cloud2class.com">www.cloud2class.com</a>
                        <hr>
                        <p>From the Cloud to the Classroom</p>
                        <p>Virtual training environments, content and trainers</p>
                        <img style="max-width: 20%; border-color: #0B486B;" src="images/GreenlogoRGB.png">
                    </section>
                </section>


                <!-- Topic Section: What is this? -->
                <!-- Description: How the workshop is going to work -->
                <section data-background="#A8DBA8">

                    <!-- The workshop: Good points -->
                    <section data-transition='fade'>
                        <aside class="notes">
                            The key attributes of the workshop
                        </aside>
                        <h3 class="col_aid_four lighttext">What is this?</h3>
                        <p>
                        <div class="quote">A fast-paced practical workshop</div>
                        <br>
                        <div class="fragment">
                            <ul>
                                <li>Technology Introduction</li>
                                <li>Team based</li>
                                <li>Collaborative</li>
                                <li>Minimum to get you up and running</li>
                                <li>Resources to carry on</li>
                            </ul>
                        </div>
                    </section>
                        
                    <!-- The workshop: Bad points -->
                    <section data-transition='fade'>
                        <aside class="notes">
                            default
                        </aside>
                        <h3 class="col_aid_four lighttext">What is this?</h3>
                        <p>
                        <div class="quote">But this means...</div>
                        <br>
                        <div class="fragment">
                            <ul>
                                <li>Lot's to cover</li>
                                <li>Won't cover everything</li>
                                <li>Less detail</li>
                                <li>Rough edges</li>
                            </ul>
                        </div>
                    </section>
                </section>


                <!-- Description: Structure -->
                <section data-background="#A8DBA8">

                    <!-- The workshop: Good points -->
                    <section>
                        <h3 class="col_aid_four lighttext">Structure</h3>
                        <p>&nbsp;
                            <ul>
                                <li>Team-based</li>
                                <li>Goals</li>
                                <li>3 Sections</li>
                                <li>Winning team gets a super-secret prize</li>
                            </ul>
                    </section>
                        

                    <section>
                        <aside class="notes">
                            ChatStop :making sure it makes sense, questions, working out how the information you learned can hekp you reach your goals
                            <br>Team-time is collaboration time. Put it into practise.
                            <br>Ask me to help out at any time
                            <br>I wont type the commands for you, but i will point you in the right direction.
                        </aside>
                        <b>Each section looks broadly like this...</b>
                        <div class=barcontainer >
                            <div class=bar1>Theory</div>
                            <div class=bar3>Demo</div>
                            <div class=bar1>Breakdown</div>
                            <div class=bar3>ChatStop</div>
                            <div class=bar1>Team-Time</div>
                        </div>
                    </font>
                    </section>

                </section>


                <!-- Description: Getting to Know you -->
                <section data-background="#A8DBA8">

                    <!-- Teams and Scoreboards -->
                    <section data-transition='fade'>
                        <aside class="notes">
                            <br>Why the matterhorn?
                            <br>teamwork
                            <br>accomplishing something
                        </aside>
                        <h3 class="col_aid_four lighttext">Teamwork and Goals</h3>
                        <div class="quote">There are no losers: Unless you're the winner</div>
                        <img style="max-width: 70%; border-color: #0B486B;" src="images/climbing-the-matterhorn.jpg">
                    </section>
                    <section data-transition='fade'>
                        <aside class="notes">
                            <br>Lets turn it from an effort into a walk in the park
                            <br>Let's get to know each other
                            <br>- names
                            <br>- expectations
                            <br>- favourite movie
                        </aside>
                        <h3 class="col_aid_four lighttext">Teamwork and Goals</h3>
                        <div class="quote">There are no losers: Unless you're the winner</div>
                        <img style="max-width: 70%; border-color: #0B486B;" src="images/walk-in-the-park.jpg">
                    </section>
                    <section>
                        <aside class="notes">
                            write down kanbanflow credentials
                        </aside>
                        <h3>Kanbanflow</h3>
                        We will use Kanbanflow is the tool to...
                        <ul>
                            <li>Track reference information</li>
                            <li>Store credentials</li>
                            <li>gather feedback</li>
                        </ul>
                    </section>
                    <section>
                        <aside class="notes">
                            <br>Log on to cloud2class
                            <br>explain
                        </aside>
                        <h3>Training Environment</h3>
                        <img style="max-width: 100%; border-color: #0B486B;" src="images/c2c-arch.jpg">
                    </section>

                </section>


                <!-- Module: Theory 1 -->
                <!-- Description: Components and Concepts -->
                <section>

                    <!-- Introduction: Splash page -->
                    <section>
                        <h2 class="col_aid_five lighttext">A little bit of theory: 1</h2>
                        <div class=barcontainer >
                            <img style="max-width: 70%; border-color: #0B486B;" src="images/ansible-logo-word.png">
                        </div>
                        <p>What is Ansible</p>
                        <p>Configuration Management</p>
                        <p>Ad-Hoc commands</p>
                        <p>Configuration files</p>
                        <p>
                    </section>
                </section>

                <section data-background="#303030" data-background-transition='fade'>
                    <section class='lighttext' id="goal-1">
                        <h3 class='red lighttext'>goal : The Webserver</h3>
                        <b>Summary:</b> Install and configure a webserver to talk to a database server using Ansible ad-hoc mode
                        <hr>
                        <p>You will need to install the prescribed software, deploy some configuration files, and potentially restart services
                        <hr>
                        <p>If the goal is met, you will be able to view one of these URLs
                        <p><a href="https://training.cloud2class.com/blue.php">BLUE</a> or <a href="https://training.cloud2class.com/red.php">RED</a> 
                    </section>
                    <section class='lighttext'>
                        <p class="exerciseTitleGreen">Part 1 :</p>
                        <div class="exerciseBlock">
                            <p>Install the following packages on the server
                            <b>red/blue-webnode-1</b></p>
                            <pre><code data-trim contenteditable>
                            nginx, php5-cli, php5-mysql, php5-fpm, python-mysqldb
                            </code></pre>
                        </div>
                        <p class="exerciseTitleGreen">Part 2 :</p>
                        <div class="exerciseBlock">
                            <p>Deploy the following two files to <b>red/blue-webnode-1</b></p>
                            <pre><code data-trim contenteditable>
                                /opt/lesson/index.php - /usr/share/nginx/html/[red|blue].php
/opt/lesson/nginx-front - /etc/nginx/sites-enabled/default
                            </code></pre>
                        </div>
                    </section>
                    <section class='lighttext'>
                        <p class="exerciseTitleGreen">Hints and Tips</p>
                        <div class="exerciseBlock">
                            <ul>
                                <li>You will need a functioning hostlist</li>
                                <li>and the correct modules</li>
                                <li>Check the module listings
                            </ul>
                        </div>
                        <p>
                        <div class="exerciseBlock">
                            You will find supporting files ( in /opt/lesson )
                        </div>
                    </section>
                </section>


                <!-- Topic Section: Introducing Ansible -->
                <!-- Description: General introduction and quotes -->
                <section data-background="#A8DBA8">

                    <!-- According to Wikipedia -->
                    <section>
                        <aside class="notes">
                        </aside>
                        <h3 class="col_aid_four lighttext">What is Ansible?</h3>
                        <div class="quote">According to Wikipedia</div>
                        <hr>
                        <ul>
                            <li>Minimal in nature. Management systems should not impose additional dependencies on the environment.</li>
                            <li>Consistent</li>
                            <li>Secure. Ansible does not deploy vulnerable agents to nodes. Only OpenSSH is required, which is already critically tested.</li>
                        </ul>
                    </section>
                    <section>
                        <ul>
                            <li>Highly reliable. The idempotent resource model is applied to deployment to prevent side-effects from re-running scripts.</li>
                            <li>Low learning curve. Playbooks use an easy and descriptive language based on YAML.</li>
                        </ul>
                    </section>

                    <!-- According to Ansible -->
                    <section>
                        <aside class="notes">
                        </aside>
                        <div class="quote">According to Ansible</div>
                        <hr>
                        Ansible is an Open Source tool that can be used for...
                        <ul>
                            <li>Configuration Management</li>
                            <li>Orchestration</li>
                            <li>Deployment</li>
                        </ul>
                    </section>
                    <section>
                        <b>Ansible strives to give you:</b>
                        <ul>
                            <li>basic ability to blast out commands to remote systems</li>
                            <li>basic ability to blast out resource instructions to a remote system</li>
                            <li>ability to trigger some configuration management automation to run</li>
                            <li>some basic ordering of what system should configure before some other system</li>
                            <li>the ability to build a general purpose workflow system, such as a pipeline of dependent steps in an IT process</li>
                        <li>That last one is awesome
                    </ul>
                    </section>
                </section>


                <!-- Description: Use-Cases -->
                <section data-background="#A8DBA8">

                    <!-- Use-cases -->
                    <section>
                        <aside class="notes">
                        </aside>
                        <h3 class="col_aid_four lighttext">Concepts</h3>
                        <div class="quote">Configuration Management</div>
                        <hr>
                        Enforcing a defined state upon a running machine in a controllable, repeatable manner.
                        <p>e.g. Software loadout, user management, service configuration (haproxy, ntp), OS configuration (kernel parameters), scheduled jobs, maintenance
                        <hr>
                        Software examples: Puppet, Salt, Chef, Ansible
                    </section>
                    <section>
                        <img style="max-width: 70%; border-color: #0B486B;" src="images/diag-config-mgmt.jpg">
                    </section>
                    <section>
                        <div class="quote">Orchestration</div>
                        <hr>
                        Performing operations on machines in relation to each other
                        <p>"...the automated arrangement, coordination, and management of complex computer systems"
                        <p>e.g. Cluster management (MongoDB, ElasticSearch), Complex or ordered installations, Multi-step application deployments
                    </section>
                </section>

                <section data-background="#A8DBA8">
                    <section>
                        <h3 class="col_aid_four lighttext">Why is it so good</h3>
                        <hr>
                        <ul>
                            <li>Low learning curve</li>
                            <li>Ansible learned a lot from other failures</li>
                            <li>Powerful</li>
                    </section>
                    <section>
                        <img style="max-width: 90%; border-color: #0B486B;" src="images/ansible-meme1.jpg">
                    </section>
                </section>

                <section data-background="#A8DBA8">
                    <section>
                        <aside class=notes>
                            Two modes of operation
                            <br>ad-hoc means run arbitrary commands over whole estate!
                            <br>destroy your entire infrastructure
                            <br>Remember, Jedi, you can also use that power for Good
                        </aside>
                        <h3 class="col_aid_four lighttext">Ad-Hoc mode</h3>
                        <hr>
                        Ad-hoc is used to perform actions on multiple nodes at once
                        <pre><code data-trim contenteditable>
                            ansible all -m ping

ansible webserver -s -m apt -a "pkg=openssl state=latest"

ansible prod-lb -a "cat /etc/haproxy/haproxy.conf"
                        </code></pre>
                    </section>
                    <section>
                        <div class="quote">Components</div>
                        <hr>
                        <ul>
                            <li>Transport: ssh</li>
                            <li>User escalation: sudo</li>
                            <li>Ansible confguration</li>
                            <li>Host selection: Inventory</li>
                            <li>Module Library</li>
                        </ul>
                    </section>
                </section>
                <section data-background="#A8DBA8">
                    <section>
                        <aside class=notes>
                        </aside>
                        <h3 class="col_aid_four lighttext">Transport SSH</h3>
                        <div class="quote">Main points</div>
                        <ul>
                            <li>SSH or Paramiko</li>
                            <li>pre-shared keys</li>
                            <li>a local user</li>
                            </li>a remote user</li>
                        </ul>
                        <hr>
                        <div class="quote">Tools of the trade</div>
                        <ul>
                            <li>ssh-keygen</li>
                            <li>ssh-keyscan</li>
                            <li>~/.ssh/authorized_keys</li>
                        </ul>
                    </section>
                </section>
                <section data-background="#A8DBA8">
                    <section>
                        <aside class=notes>
                        </aside>
                        <h3 class="col_aid_four lighttext">User Escalation: sudo</h3>
                        <hr>
                        User accounts must have the capability to perform their respective actions
                        <p>Generally this means a dedicated configuration account with sudo access
                    </section>
                </section>
                <section data-background="#A8DBA8">
                    <section>
                        <aside class=notes>
                            <br>your accounts are not root
                            <br>create a local directory
                            <br>take a look at the local .cfg
                        </aside>
                        <h3 class="col_aid_four lighttext">Ansible Configuration</h3>
                        <div class="quote">ansible.cfg is looked for with the following priority:</div>
                        <hr>
                        <ul>
                            <li>ANSIBLE_CONFIG (an environment variable)</li>
                            <li>ansible.cfg (in the current directory)</li>
                            <li>.ansible.cfg (in the home directory)</li>
                            <li>/etc/ansible/ansible.cfg</li>
                        </ul>
                    </section>
                    <section>
                        <aside class=notes>
                            Define which nodes you are goin to operate on
                            <br>and groupings of nodes
                            <br>show a static inventory file
                        </aside>
                        <h3 class="col_aid_four lighttext">Inventory files</h3>
                        <div class="quote">Static :</div>
                        <p>
                        flatfiles containing lists of
                        <ul>
                            <li>Hosts - FQDN, hostname, or IP</li>
                            <li>Variables</li>
                            <li>Groups - webserver, database, loadbalancers</li>
                        </ul>
                    </section>
                    <section>
                        <div class="quote">Dynamic :</div>
                        <p>Any executable that can return JSON host objects
                        <p>Provides integration with...
                        <p> "Cobbler AWS BSD Jails
DigitalOcean
Google Compute Engine
Linode
OpenShift
OpenStack Nova
Red Hat's SpaceWalk
Vagrant
Zabbix
Bash"
                        
                    </section>
                </section>
                <section data-background="#A8DBA8">
                    <section>
                        <aside class=notes>
                        </aside>
                        <h3 class="col_aid_four lighttext">Module Library</h3>
                        <hr>
                        A collection of functions that provide Ansibles functionality
                        <p>
                        <ul>
                            <li>Ansible ships with over 200 modules</li>
                            <li>divided into Core (maintained by Ansible)</li>
                            <li>and Extra (community)</li>
                            <li>All return JSON</li>
                        </ul>
                    </section>
                    <section>
                        <pre><code data-trim contenteditable>
                         ansible-doc -l   (list all modules)

ls /usr/share/ansible (show module categories)

http://docs.ansible.com/ansible/modules_by_category.html (online index)

ansible-doc [module] ("man-page" for a module)
                        </code>
                        </pre>
                        <p>
                        <pre><code data-trim contenteditable>
ansible all -m [module]
ansible all -m [module] -a [key=value key=value]
ansible all -m [module] -a [whole string]
                        </code>
                        </pre>
                    </section>
                </section>
                <section>
                    <aside class=notes>
                        <br>is it making sense
                        <br>how is it feeding into the goals
                    </aside>
                    <h3 class="col_aid_four lighttext">ChatStop</h3>
                        <img style="max-width: 90%; border-color: #0B486B;" src="images/walk-in-the-park.jpg">
                </section>
                <section>
                    <!-- Introduction: Splash page -->
                    <section>
                        <h2 class="col_aid_five lighttext">A little bit of theory: 2</h2>
                        <div class=barcontainer >
                            <img style="max-width: 70%; border-color: #0B486B;" src="images/ansible-logo-word.png">
                        </div>
                        <p>Playbooks</p>
                        <p>Facts and Variables</p>
                        <p>Templates</p>
                    </section>
                </section>
 
                <section data-background="#303030" data-background-transition='fade'>
                    <section class='lighttext' id="goal-2">
                        <h3 class='red lighttext'>goal : Playbooks</h3>
                        <hr>
                        <p class="exerciseTitleGreen">Part 1 :</p>
                        <div class="exerciseBlock">
                            <b>Summary:</b> Convert the individual steps from Goal 1 into a single Playbook
                            <p>Your Playbook should be divided into sensible Plays
                        </div>
                    </section>
                    <section class='lighttext'>
                        <p class="exerciseTitleGreen">Part 2 :</p>
                        <div class="exerciseBlock">
                            <b>Summary:</b> The Satellite Playbook and its attendent configuration are behaving inefficiently
                        </div>
                        <p>
                        <div class="exerciseBlock">
                            <p>Reduce the the time it takes to complete the Plays
                            <p>The lowest time wins
                            <p>You may edit any of the files, but do not modify the module calls themselves
                        </div>
                        <p>
                        <div class="exerciseBlock">
                            <p>The Playbook and config are in /opt/lesson/satellite
                        </div>
                    </section>
                    <section class='lighttext'>
                        <p class="exerciseTitleGreen">Hints and Tips</p>
                        <div class="exerciseBlock">
                            <ul>
                                <li>There are various ways to optimize:</li>
                                <li>Some defaults have been changed</li>
                                <li>Consider how to optimize each individual step</li>
                            </ul>
                        </div>
                    </section>
                </section>


                <!-- Topic Section: Introducing Ansible -->
                <!-- Description: General introduction and quotes -->
                <section data-background="#A8DBA8">

                    <!-- According to Wikipedia -->
                    <section>
                        <aside class="notes">
                            Show a demo playbook
                            run through it
                        </aside>
                        <h3 class="col_aid_four lighttext">Playbooks</h3>
                        <div class="quote">"are Ansibles configuration, deployment and orchestration language"</div>
                        <p>
                        <ul>
                            <li>Describe policies to enforce</li>
                            <li>represent steps of a process</li>
                            <li>sequence multi-tier rollouts</li>
                            <li>delegate actions to other hosts</li>
                            <li>defined in YAML</li>
                            <li>Arbitrary filename</li>
                            <li>Contain Plays</li>
                        </ul>
                    </section>
                    <section>
                        <pre><code data-trim contenteditable>
---
- hosts: webservers
  vars:
    http_port: 80
    max_clients: 200
  remote_user: root
  tasks:
  - name: ensure apache is at the latest version
    yum: pkg=httpd state=latest
  - name: write the apache config file
    template: src=/srv/httpd.j2 dest=/etc/httpd.conf
  - name: ensure apache is running (and enable it at boot)
    service: name=httpd state=started enabled=yes

                        </code></pre>
                    </section>
                    <section>
                        <h3 class="col_aid_four lighttext">Plays</h3>
                        <ul>
                            <li>Plays are run in order</li>
                            <li>Plays consist of blocks</li>
                            (hosts, vars, tasks, handlers)
                            <li>Blocks define actions
                            <li>Configuration items can be specified</li>
                            (remote_user, sudo, gather_facts)
                        </ul>
                    </section>
                    <section>
                        <pre><code data-trim contenteditable>
- hosts: webservers
  remote_user: root

  tasks:
  - name: ensure apache is at the latest version
    yum: pkg=httpd state=latest
  - name: write the apache config file
    template: src=/srv/httpd.j2 dest=/etc/httpd.conf
                        </code></pre>
                    </section>
                    <section>
                        <h3 class="col_aid_four lighttext">Playbook mode</h3>
                        <hr>
                        <p>Run Playbooks with the "ansible-playbook" command
                        <p>
                        <pre><code data-trim contenteditable>
ansible-playbook playbook.yml

ansible-playbook --list-tasks runme.yaml

ansible-playbook -C staging.yml
                        </code></pre>
                    </section>
                </section>
                <section data-background="#A8DBA8">
                    <section>
                        <h3 class="col_aid_four lighttext">Facts</h3>
                        <hr>
                        <p>Information about a node in a playbook is gathered for use by that playbook</p>
                        <ul>
                            <li>Includes multiple sources: Ansible, Facter, ohai)</li>
                            (if they are installed)
                            <li>Facts may be gathered from any node you reference</li>
                            <li>(deactivated with "gather_facts: false" for performance)</li>
                            <li>Provided by the "setup" module</li>
                            <li>Custom facts can be deployed in /etc/ansible/facts.d</li>
                        </ul>
                    </section>
                    <section>
                        <pre><code data-trim contenteditable>
ansible all -m setup (list all facts)

ansible all -m setup -a 'filter=ohai_*' (filter for type ohai)
                        </code></pre>
                        <p>and from ansible-doc setup:
                        <pre><code data-trim contenteditable>
# Display facts from all hosts and store them indexed by I(hostname) at C(/tmp/facts).
ansible all -m setup --tree /tmp/facts
# Display only facts regarding memory found by ansible on all hosts and output them.
ansible all -m setup -a 'filter=ansible_*_mb'
# Display only facts returned by facter.
ansible all -m setup -a 'filter=facter_*'
# Display only facts about certain interfaces.
ansible all -m setup -a 'filter=ansible_eth[0-2]'
                        </code></pre>
                    </section>
                    <section>
                        <b>Some Playbook code</b>
                        <p>
                        <pre><code data-trim contenteditable>
                        - hosts: monitoring
  tasks: []
                        </code></pre>
                    </section>
                </section>
                <section data-background="#A8DBA8">
                    <section>
                        <h3 class="col_aid_four lighttext">Variables</h3>
                        <hr>
                        <p>Variables are set in multiple places, and can be used in templates or directly in Playbooks as part of loops or logic statements
                        <p>Variables can be set... 
                    </section>
                    <section>
                        <b>...in Inventory</b>
                        <p>
                        <pre><code data-trim contenteditable>
[atlanta]
host1
host2

[atlanta:vars]
ntp_server=ntp.atlanta.example.com
proxy=proxy.atlanta.example.com
                        </code></pre>
                        <p>
                        <pre><code data-trim contenteditable>
[atlanta]
host1 http_port=80 maxRequestsPerChild=808
host2 http_port=303 maxRequestsPerChild=909
                        </code></pre>
                    </section>
                    <section>
                        <b>...in Playbooks</b>
                        <p>
                        <pre><code data-trim contenteditable>
- hosts: webservers
  vars:
    http_port: 80
                        </code></pre>
                    </section>
                    <section>
                        <b>...in ansible/group_vars and host_vars</b>
                        <pre><code data-trim contenteditable>
/etc/ansible/group_vars/raleigh
/etc/ansible/group_vars/webservers
/etc/ansible/host_vars/foosball
                        </code></pre>
                    </section>
                    <section>
                        <div class="quote">But what good is that???</div>
                    </section>
                </section>
                <section data-background="#A8DBA8">
                    <section>
                        <h3 class="col_aid_four lighttext">Templates</h3>
                        <p>Tailor your configuration files before sending them to your nodes
                        <ul>
                            <li>Jinja2
                            <li>http://jinja.pocoo.org/docs/</li>
                            <li>"template" module is similar to the "file" module usage</li>
                            <li>{ {my_variable }}</li>
                        </ul>
                    </section>
                    <section>
                        <div class="quote">Create your template</div>
                        <p>
                        A simple template
                        <pre><code data-trim contenteditable>
/etc/ssh/sshd_config - sshd_config.j2
...
# What ports, IPs and protocols we listen for
Port {{ ssh_port }}
...
                        </code></pre>
                        <p>
                        or inside a Playbook
                        <pre><code data-trim contenteditable>
                        template: src=foo.cfg.j2 dest={{ remote_install_path }}/foo.cfg
                        </code></pre>

                    </section>
                    <section>
                        <div class="quote">Reference your template</div>
                        <p>
                        <pre><code data-trim contenteditable>
# Example from Ansible Playbooks
- template: src=/mytemplates/foo.j2 dest=/etc/file.conf owner=bin group=wheel mode=0644
                        </code></pre>
                    </section>
                </section>






                <section>
                    <aside class=notes>
                        <br>is it making sense
                        <br>how is it feeding into the goals
                    </aside>
                    <h3 class="col_aid_four lighttext">ChatStop</h3>
                        <img style="max-width: 90%; border-color: #0B486B;" src="images/walk-in-the-park.jpg">
                </section>
                <section>
                    <!-- Introduction: Splash page -->
                    <section>
                        <h2 class="col_aid_five lighttext">A little bit of theory: 3</h2>
                        <div class=barcontainer >
                            <img style="max-width: 70%; border-color: #0B486B;" src="images/ansible-logo-word.png">
                        </div>
                        <p>Handlers</p>
                        <p>Roles</p>
                        <p>Ansible Galaxy</p>
                        <p></p>
                    </section>
                </section>
 
                <section data-background="#303030" data-background-transition='fade'>
                    <section class='lighttext' id="goal-3">
                        <h3 class='red lighttext'>goal : Orchestration</h3>
                        <hr>
                        <div class="exerciseBlock">
                            <b>Summary:</b> A common IT service task is to update content on live machines without cuasing an outage
                            <p>Update these two machines that form a simple cluster for Red and Blue
                        </div>
                        <img style="max-width: 70%; border-color: #0B486B;" src="images/diag-project3.jpg">
                    </section>
                    <section class='lighttext'>
                        <p class="exerciseTitleGreen">Seamless upgrade :</p>
                        <div class="exerciseBlock">
                            <ul>
                                <li>Take each node out of service one at a time:</li>
                                haproxy on red/blue-webnode-1
                                <li>Update the nginx configuration for the web nodes:</li>
                                red/blue-cluster-1 and red/blue-cluster-2
                                <li>Restart nginx</li>
                                <li>Put the node back in service</li>
                                <li>The new configuration file is in <b>/opt/lesson/orchestrate</b></li>
                            </ul>
                        </div>
                        <p>
                        <div class="exerciseBlock">
                            Any lost traffic loses you the point!
                        </div>
                    </section>
                    <section class='lighttext'>
                        <p class="exerciseTitleGreen">Hints and Tips</p>
                        <div class="exerciseBlock">
                            You will need:
                            <ul>
                                <li>A simple template for haproxy</li>
                                <li>Pre and Post execution step in your Playbook</li>
                                <li>http://docs.ansible.com/ansible/guide_rolling_upgrade.html</li>
                            </ul>
                        </div>
                    </section>
                </section>

                <section data-background="#A8DBA8">
                    <section>
                        <aside class=notes>
                            common to "include" the handler from a seperate directory of common handlers
                        </aside>
                        <h3 class="col_aid_four lighttext">Handlers</h3>
                        A specific type of task executed after a different task has completed
                        <p>Handlers allow clean-up and actions such as service restarts
                        <pre><code data-trim contenteditable>
  tasks:
  - name: write the apache config file
    template: src=/srv/httpd.j2 dest=/etc/httpd.conf
    notify:
    - restart apache
  handlers:
    - name: restart apache
      service: name=httpd state=restarted
                        </code></pre>
                    </section>
                </section>
                <section data-background="#A8DBA8">
                    <section>
                        <aside class=notes>
                        </aside>
                        <h3 class="col_aid_four lighttext">Roles</h3>


 
 

                <section>


                        <p>Handlers</p>


                Pipelining
                application deployment
                ochestration examples
            </section>

            <section>
                <h2 class="col_aid_five lighttext">Reference</h2>
                <p>
                <p>Installation - <a href="stuff">Cheatsheet</a> - <a href="http://docs.ansible.com/ansible/intro_installation.html">docs.ansible.com</a></p>


                <!-- End of Content -->
            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>

            // Full list of configuration options available at:
            // https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                                parallaxBackgroundImage: "images/green-cloud.jpg",

                                     // Parallax background size
                                parallaxBackgroundSize: "3000px 3000px",
                history: true,
                center: false,
                previewLinks: true,

                transition: 'slide', // none/fade/slide/convex/concave/zoom                transition: 'slide', // none/fade/slide/convex/concave/zoom

                // Optional reveal.js plugins
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true },
                    { src: 'plugin/notes/notes.js', async: true }
                ]
            });

        </script>

    </body>
</html>


